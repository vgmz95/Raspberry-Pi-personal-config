---
- name: Ensure NetworkManager tools are present
  ansible.builtin.package:
    name: network-manager
    state: present

- name: Configure network connection.
  community.general.nmcli:
    conn_name: "{{ network_conn_name }}"
    ifname: "{{ network_interface }}"
    type: ethernet
    autoconnect: true
    method4: auto
    method6: auto
    dns4: "{{ network_dns4 }}"
    dns4_ignore_auto: true
    dns6: "{{ network_dns6 }}"
    dns6_ignore_auto: true
    state: present

- name: Increase net.core.rmem_max
  ansible.posix.sysctl:
    name: net.core.rmem_max
    value: 7500000

- name: Increase net.core.wmem_max
  ansible.posix.sysctl:
    name: net.core.wmem_max
    value: 7500000
